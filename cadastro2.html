<?php 
  error_reporting(E_ERROR | E_PARSE);

  $pdo = require './php/connect.php';

  session_start();

  $data = $_POST['data'];
  $senha = $_POST['senha'];
  $cSenha = $_POST['confSenha'];

  if($data == '' || $senha == '' || $cSenha == ''){
    echo "Preencha todos os campos.";
  }else{
    if($senha != $cSenha){
      echo "Confirmação de senha invalida.";
    }
    else{
      $senha = password_hash($_POST['senha'], PASSWORD_DEFAULT);

      $sql = 'insert into usuario (nome, email, senha, telefone, datanascimento) values (?, ?, ?, ?, ?)';
      
      $prepare = $pdo->prepare($sql);
      
      //passando dados para o banco
      $prepare->bindParam(1, $_SESSION['name']);
      $prepare->bindParam(2, $_SESSION['email']);
      $prepare->bindParam(3, $senha);
      $prepare->bindParam(4, $_SESSION['phone']);
      $prepare->bindParam(5, $data);

      $prepare->execute();
      echo "Conta cadastrada, faça login na próxima pagína";
      header('Location: login.php');

    }
  }
?>
<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Tela de Login</title>
    <link rel="stylesheet" href="./css/cadastro2.css" />

    <link rel="preconnect" href="https://fonts.googleapis.com">
  	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@600&display=swap" rel="stylesheet">

    <link href="./bootstrap-5.2.0-beta1-dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="./css/style.min.css" rel="stylesheet">
  </head>
  <body>
  <!-- Header -->
    <?php 
      include_once './includes/header.php';
    ?>   
  <!-- fim Header -->
    <!-- FORMS -->
    <article>
      <h1>
        Seja bem-vindo a<br />
        Fundação T&C
      </h1>
    </article>
    <section class="coluna-a">
      <main>
        <form action="" method="post">
          <h3>Data de nascimento</h3>
          <input
            type="date"
            name="data"
            placeholder="Data de nascimento"
            maxlength="200"
          />
          <h3>Crie uma senha</h3>
          <input
            type="password"
            name="senha"
            placeholder="Senha:"
            maxlength="200"
          />
          <h3>Confirme a senha</h3>
          <input
            type="password"
            name="confSenha"
            placeholder="Confirmação de senha"
            maxlength="200"
          />
          <h3>Termos de compromisso:</h3>
          <div class="dropdown">
            <button class="dropbt">Leia Mais..
              <i class="fa fa-caret-down"></i>
            </button>
            <div class="dropdown-content">
              <a href="#">Link 1</a>
              <a href="#">Link 2</a>
              <a href="#">Link 3</a>
            </div>
          </div>
          <button onclick="" name="aceito" id="aceito">Aceito</button>
          <button type="submit" name="proximo" id="proximo">Proximo -></button>
        </form>
      </main>
      <!-- SVG -->
      <div class="svg-container">
        <img src="./assets/nova-etapa.svg"/>
        <h3>Pronto para ingressar<br> em uma nova etapa ?</h3>
        <p>Lorem ipsum dolor sit amet, consectetur<br> adipiscing elit. Suspendisse tincidunt urna<br> eget nibh commodo, vel posuere erat vulputate.<br> Aenean aliquam, velit sed pharetra<br> interdum, turpis dolor convallis leo, a<br> consectetur urna nisl vitae turpis. Praesent<br> vel massa lectus. Vestibulum<br> tincidunt dui. Vivamus lacinia urna.<br>
          Um beijo na bochecha,<br>
                              Equipe T&C
</p>
        
      </div>
    </section>
    <!-- RODAPE -->
    <footer>
      <p class="cadastro-prof">
        Quer fazer o cadastro como professor?<br>
        <a href="#"> Clique aqui </a></p>
      <div class="rodape">
        <img class="ondas" src="./assets/wave.svg" alt="Rodapé da Pagina">
        </svg>
      </div>
    </footer>
  </body>
</html>
